{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\c\\\\Documents\\\\myWebsites\\\\ChatApp\\\\unichat-course-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\c\\\\Documents\\\\myWebsites\\\\ChatApp\\\\unichat-course-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\c\\\\Documents\\\\myWebsites\\\\ChatApp\\\\unichat-course-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router-dom';import{ChatEngine}from'react-chat-engine';import{auth}from'../Firebase';import{useAuth}from'../contexts/AuthContext';import axios from'axios';var Chats=function Chats(){var history=useHistory();var _useAuth=useAuth(),user=_useAuth.user;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];console.log(user);var handleLogout=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return auth.signOut();case 2:history.push('/');case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleLogout(){return _ref.apply(this,arguments);};}();var getFile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url){var res,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(url);case 2:res=_context2.sent;_context2.next=5;return res.blob();case 5:data=_context2.sent;return _context2.abrupt(\"return\",new File([data],'userPhoto.jpg',{type:'image/jpeg'}));case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function getFile(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){if(!user||user===null){history.push('/');return;}axios.get('https://api.chatengine.io/users/me/',{headers:{'project-id':process.env.REACT_APP_CHAT_ENGINE_ID,'user-name':user.email,'user-secret':user.uid}}).then(function(){setLoading(false);}).catch(function(){var formdata=new FormData();formdata.append('email',user.email);formdata.append('username',user.email);formdata.append('secret',user.uid);getFile(user.photoURL).then(function(avatar){formdata.append('avatar',avatar,avatar.name);axios.post('https://api.chatengine.io/users/',formdata,{headers:{'private-key':process.env.REACT_APP_CHAT_ENGINE_KEY}}).then(function(){return setLoading(false);}).catch(function(error){return console.log(error);});});});},[user,history]);if(!user||loading)return'Loading...';return/*#__PURE__*/React.createElement(\"div\",{className:\"chats-page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"nav-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"logo-tab\"},\"Unichat\"),/*#__PURE__*/React.createElement(\"div\",{onClick:handleLogout,className:\"logout-tab\"},\"Logout\")),/*#__PURE__*/React.createElement(ChatEngine,{height:\"calc(100vh - 66px)\",projectID:process.env.REACT_APP_CHAT_ENGINE_ID,userName:user.email,userSecret:user.uid}));};export default Chats;","map":{"version":3,"sources":["C:/Users/c/Documents/myWebsites/ChatApp/unichat-course-master/src/components/chats.js"],"names":["React","useState","useEffect","useHistory","ChatEngine","auth","useAuth","axios","Chats","history","user","loading","setLoading","console","log","handleLogout","signOut","push","getFile","url","fetch","res","blob","data","File","type","get","headers","process","env","REACT_APP_CHAT_ENGINE_ID","email","uid","then","catch","formdata","FormData","append","photoURL","avatar","name","post","REACT_APP_CHAT_ENGINE_KEY","error"],"mappings":"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","sourcesContent":["import React, { useState, useEffect} from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport {  ChatEngine } from 'react-chat-engine';\r\nimport { auth } from '../Firebase';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport axios from 'axios';\r\n\r\n\r\nconst Chats = () => {\r\n\r\n  const history = useHistory();\r\n  const { user } = useAuth();\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  console.log(user);\r\n\r\n  const handleLogout = async() => {\r\n    await auth.signOut();\r\n\r\n    history.push('/');\r\n  }\r\n\r\n  const getFile = async (url) =>{\r\n    const res = await fetch(url);\r\n    const data = await res.blob();\r\n\r\n    return new File([data],'userPhoto.jpg', {type: 'image/jpeg'});\r\n  }\r\n\r\n  useEffect(()=>{\r\n\r\n\r\n    if(!user || user===null){\r\n      history.push('/');\r\n\r\n      return;\r\n    }\r\n\r\n    axios.get('https://api.chatengine.io/users/me/',{\r\n      headers: {\r\n        'project-id': process.env.REACT_APP_CHAT_ENGINE_ID,\r\n        'user-name': user.email,\r\n        'user-secret': user.uid,\r\n      }\r\n    })\r\n    .then(()=>{\r\n      setLoading(false);\r\n    })\r\n    .catch(()=>{\r\n      let formdata = new FormData();\r\n      formdata.append('email',user.email);\r\n      formdata.append('username',user.email);\r\n      formdata.append('secret',user.uid);\r\n\r\n      getFile(user.photoURL)\r\n      .then((avatar)=>{\r\n        formdata.append('avatar',avatar,avatar.name);\r\n\r\n        axios.post('https://api.chatengine.io/users/',\r\n        formdata,\r\n        {headers: {'private-key': process.env.REACT_APP_CHAT_ENGINE_KEY}})\r\n        .then(()=> setLoading(false))\r\n        .catch((error)=>console.log(error))\r\n      })\r\n    })\r\n  },[user,history]);\r\n\r\n  if(!user || loading) return 'Loading...'\r\n\r\n  return(\r\n    <div className='chats-page'>\r\n\r\n      <div className='nav-bar'>\r\n\r\n        <div className='logo-tab'>\r\n          Unichat\r\n        </div>\r\n\r\n        <div onClick={handleLogout} className='logout-tab'>\r\n          Logout\r\n        </div>\r\n      </div>\r\n\r\n      <ChatEngine\r\n        height='calc(100vh - 66px)'\r\n        projectID= {process.env.REACT_APP_CHAT_ENGINE_ID}\r\n        userName={user.email}\r\n        userSecret={user.uid}\r\n        />\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chats;\r\n"]},"metadata":{},"sourceType":"module"}